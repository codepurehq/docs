---
title: Seccomp Profile Not Set (CIS 5.21)
description: Risks of disabling the default Seccomp profile in Docker
---

## Impact & Risk Analysis

* **Severity:** High
* **CIS Benchmark:** CIS 5.21
* **Impact:** **Kernel Surface Attack.** Seccomp (Secure Computing Mode) restricts the system calls a container can make to the kernel. Disabling it exposes the kernel to a wide range of attacks if the container is compromised.

## Common Misconfiguration

Running a container with the security option `seccomp=unconfined`, which disables the default filter and allows all system calls.

## Vulnerable Example

```yaml
# Vulnerable docker-compose.yml
version: '3.8'
services:
  app:
    image: python:3.9
    security_opt:
      - seccomp:unconfined  # DANGEROUS! Disables all system call filtering

```

```bash
# Vulnerable docker run command
docker run --security-opt seccomp=unconfined myapp:latest

```

## Secure Example

```yaml
# Secure docker-compose.yml
version: '3.8'
services:
  app:
    image: python:3.9
    # Option 1: Do nothing (Docker enables the default profile automatically)
    
    # Option 2: Explicitly enforce the default profile (Best Practice)
    security_opt:
      - seccomp:default

```

## Custom Profile Strategy (Advanced)

If you need specific system calls (like for debugging), do not use `unconfined`. Instead, create a custom JSON profile that allows *only* what you need.

```yaml
# docker-compose using custom profile
services:
  app:
    image: python:3.9
    security_opt:
      - seccomp:./custom-seccomp-profile.json

```
