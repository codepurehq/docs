---
title: Azure Secrets Exposure
description: Detecting and preventing Azure credentials in code
---

## Common Misconfiguration

Exposed Azure service principal credentials and storage keys can compromise your entire Azure subscription.

### Vulnerable Example

```javascript
// VULNERABLE - Hardcoded Azure credentials
const { DefaultAzureCredential, ClientSecretCredential } = require("@azure/identity");
const { SecretClient } = require("@azure/keyvault-secrets");

// Never hardcode these!
const TENANT_ID = "72f988bf-86f1-41af-91ab-2d7cd011eb47";
const CLIENT_ID = "ad7e1c3a-c8ae-4bc5-b461-f495c6c5b1a2";
const CLIENT_SECRET = "8Q~.vR3fakeSecretHereXAMPLE123456";

// Hardcoded storage account key
const STORAGE_CONNECTION_STRING = "DefaultEndpointsProtocol=https;AccountName=mystorageaccount;AccountKey=lJzRc1YdHaAA2KCNJJ1tkYwF/+mKK6Ygw0JQV4f9WhvYgPxCPKH8SOQPSXQJmYL5xYFsx2cXtwFakeKey==;EndpointSuffix=core.windows.net";

// Hardcoded CosmosDB key
const cosmosConfig = {
    endpoint: "https://myaccount.documents.azure.com:443/",
    key: "C0sm0sDBFakeKeyHereXAMPLEKEY123456789==",
    database: "production"
};

const credential = new ClientSecretCredential(TENANT_ID, CLIENT_ID, CLIENT_SECRET);
```

## Secure Example



## Detection Patterns

  * Azure Client Secret: [a-zA-Z0-9~._-]{34,}.
  * Storage Account Key: [a-zA-Z0-9/+=]{86}==.
  * CosmosDB Key: [a-zA-Z0-9=]{86}==.

## Prevention Best Practices

  1. Use Managed Service Identity (MSI) where possible.
  2. Store secrets in Azure Key Vault.
  3. Use Azure App Configuration for settings.
  4. Implement RBAC with least privilege.
  5. Enable Azure Policy for compliance.
  6. Rotate secrets automatically.